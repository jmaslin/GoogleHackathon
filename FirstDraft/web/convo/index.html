<!-- 
	FILE NAME: CONVO/INDEX.HTML
	FIILE AUTH: JUSTIN
	USES: CONVO.CSS
 -->
<!DOCTYPE html>

<html lang="en">
	<head>
		<script src="../assets/js/jquery-2.1.1.min.js"></script>

		<!-- BOOTSTRAP -->
		<link href="../assets/css/bootstrap.css" rel="stylesheet" />
		<script src="../assets/js/bootstrap.js"></script>

		<!-- CUSTOM -->
		<link href="../assets/css/design.css" rel="stylesheet" />
		<link href="../assets/css/convo.css" rel="stylesheet" />

    <!-- FONTS -->
    <link href='http://fonts.googleapis.com/css?family=Lato|Source+Sans+Pro|Ubuntu\Bitter' rel='stylesheet' type='text/css'>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">

	</head>
	<body>	

		<div class="container">

			<div class="row">
				<div id="sidebar" class="col-sm-3">
					<div class="row">
						<div class=" input-lg">
							<input type="text" class="form-control" id="search" autocomplete="off" placeholder="Search">
							<span class="glyphicon glyphicon-search form-control-feedback" aria-hidden="true"></span>
						</div>
					</div>
					<br />
					<div class="row">
						<h3>Popular Tags</h3>
					</div>
				</div>
				<div id="main" class="col-sm-7 col-sm-offset-1"> <!-- MAIN PAGE CONTENT -->
					<div class="row"> <!-- Page Heading -->
						<h2 class="title">The Convo Bay</h2>
						<hr />
					</div>
					<div id="listings" class="row"> <!-- Start Listings -->
						<!-- SAMPLE -->
						<!-- <div class="chatGroup col-sm-3 col-xs-4">
							<a href="chat#24" class="chatExpand imageLink">
							<img class="img img-responsive img-thumbnail" src="../assets/img/person.gif">
							<p><strong><span class="chatGroupName">Group Name</span></strong></p>
							</a>
						</div> -->
					</div> <!-- End Listings -->
				</div> <!-- END MAIN PAGE CONTENT -->
			</div>

		</div>
		
	</body>
</html>

<!-- MODAL MAIN -->
<div class="modal fade" id="chatModal" tabindex="-1" role="dialog" aria-labelledby="chatModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="chatModal">Chat</h4>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
	
	$( document ).ready(function() {
			
		getListings();
	});

	$('#chatModal').on('show.bs.modal', function (event) {
	  var button = $(event.relatedTarget) // Button that triggered the modal
	  var chatName = button.data('modal-name') // Extract info from data-* attributes
	  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
	  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
	  var modal = $(this)
	  modal.find('.modal-title').text('Chat: '+chatName)
	  // modal.find('.modal-body input').val(recipient)
	})

	function getListings(type) {

		$.ajax({
			type: "get", 
			url: "text.php", 
			data: "type="+type, 
			success: function(data) {

				data = $.parseJSON(data);
				console.log(data);
				$.each(data, function(i, v) {

					var listing = ('\
						<div id="'+i+'" class="chatGroup col-sm-3 col-xs-4" tags="'+v.tags+'">\
							<a href="chat#'+i+'" class="chatExpand imageLink">\
							<img class="img img-responsive img-thumbnail" src="../assets/img/person.gif">\
							<button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#chatModal" data-modal-name="'+v.name+'">'+v.name+'</button>\
						</div>\
					');
					$('#listings').append(listing);
				});
				
				//$('#listings').trigger('create');
			}
		});

	}

	$( document ).on('click', '.chatExpand', function(e) {
		e.preventDefault();
		e.stopPropagation();
		launchChat($(this).parent().attr('id'));
	});

	function launchChat(id) {
		console.log(id);
	}

</script>
